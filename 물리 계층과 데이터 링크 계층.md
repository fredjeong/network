# 2. 물리 계층과 데이터 링크 계층

## 2.1 이더넷

### 이더넷 표준

- 이더넷(Ethernet)
    - 유선 LAN 환경의 표준 기술
    - 다양한 통신 매체의 규격들과 송수신되는 프레임의 형태, 프레임을 주고받는 방법 등이 정의된 네트워크 기술

### 통신 매체 표기 형태

- 이더넷 표준 규격에 따라 구현된 통신 매체 명명법
    - 전송 속도(data rate)
    - BASE(BASEband)
        - 변조 타입(modulation type)을 의미
            - 비트 신호로 변환된 데이터를 통신 매체로 전송하는 방법
        - 이외에 브로드밴드(BROADband) 등이 있음
    - 추가 특성(additional distinction)
        - 전송 가능한 최대 거리
        - 물리 계층 인코딩 방식
        - 레인 수

### 통신 매체 종류

- 동축 케이블(C)
- 트위스티드 페어 케이블(T)
- 단파장 광섬유 케이블(S)
- 장파장 광섬유 케이블(L)

### 이더넷 프레임(Ethernet frame)

- 이더넷 프레임 헤더
    - 프리앰블(preamble)
        - 이더넷 프레임의 시작을 알리는 8바이트(64비트) 크기의 정보
        - 송수신지 간의 동기화를 위해 사용되는 정보
        - 수신지는 프리앰블을 통해 이더넷 프레임이 오고 있음을 인지
    - 수신지/송신지 MAC 주소
        - 네트워크 인터페이스마다 부여되는 6바이트(48비트) 길이의 주소
        - LAN 내의 수신지와 송신지를 특정
        - 고유하고 변경되지 않는 주소로 네트워크 인터페이스마다 부여됨
    - 타입
        - 이더넷 프레임이 어떤 정보를 캡슐화했는지 나타냄
        - 대표적으로 상위 계층에서 사용된 프로토콜의 이름이 명시
    - 길이
        - 프레임의 크기(길이)
        
- 페이로드
    - 데이터
        - 상위 계층에서 전달받거나 상위 계층으로 전달해야 할 내용
        - 네트워크 계층의 데이터와 헤더를 합친 PDU를 포함
- 트레일러
    - FCS (Frame Check Sequence)
        - 수신한 이더넷 프레임에 오류가 있는지 확인하기 위한 필드
        - CRC(Cyclic Redundancy Check)라고 불리는 오류 검출용 값을 포함
    - 송신지는 프리앰블을 제외한 나머지 필드 값들을 바탕으로 CRC 값을 계산한 후 이 값을 FCS 필드에 명시
    - 수신지는 수신한 프레임에서 프리앰블과 FCS 필드를 제외한 나머지 필드 값들을 바탕으로 CRC 값을 계산한 뒤 이 값을 FCS 필드 값과 비교하여 비교 값이 일치하지 않으면 프레임에 오류가 있다고 판단, 해당 프레임을 폐기

## 2.2 NIC와 케이블

- NIC (Network Interface Controller)
    - 호스트와 통신 매체를 연결하고, 통신 매체를 통해 전달되는 신호를 변환하며, MAC 주소가 부여되는 네트워크 장비
    - 어떤 프레임이 자신에게 도달했을 때 자신과는 관련 없는 수신지의 MAC 주소가 명시된 프레임이거나, FCS 필드를 토대로 오류를 검출해 잘못된 프레임일 때 이들을 폐기
- 트위스티드 페어 케이블(twisted pair cable)
    - 구리 선으로 전기 신호를 주고받는 통신 매체
- 광섬유 케이블(fiber optic cable)
    - 빛(광신호)를 이용해 정보를 주고받는 케이블

## 2.3 허브

### 주소 개념이 없는 물리 계층

- 송수신지를 특정할 수 있는 주소는 데이터 링크 계층부터 존재하며, 물리 계층은 주소를 가지지 않음
- 물리 계층에서는 단지 호스트와 통신 매체 간의 연결과 통신 매체 상의 송수신만 이루어짐
- 물리 계층의 네트워크 장비는 송수신되는 정보에 대한 조작이나 판단을 하지 않음

### 허브(Hub) 또는 리피터 허브(repeater hub)

- 여러 대의 호스트를 연결하는 물리 계층의 네트워크 장비
- 특징
    - 전달받은 신호를 다른 모든 포트로 그대로 다시 내보냄
        - 주소 개념이 없기에 수신지를 특정할 수 없으며, 신호를 전달받으면 송신지를 제외한 모든 포트에 해당 신호를 내보냄
        - 신호를 전달받은 호스트는 데이터 링크 계층에서 패킷의 MAC 주소를 확인하고 자신과 관련없는 주소는 폐기
    - 반이중(half duplex) 모드 통신
        - 호스트 A가 B에게 메시지를 송신할 때 호스트 B는 A에게 송신할 수 없음
        - 동시에 허브에 신호를 송신할 시 충돌(collision) 발생
            - 허브에 호스트가 많이 연결되어 있을수록(콜리전 도메인의 범위가 클수록) 충돌 발생 가능성이 높음

### CSMA/CD (Carrier Sense Multiple Access with Collision Detection)

- 반이중 이더넷 네트워크에서 충돌을 방지하는 프로토콜
- 캐리어 감지(carrier sense)
    - 메시지를 보내기 전에 현재 네트워크 상에서 전송 중인 것이 있는지를 확인
- 다중 접근(multiple access)
    - 복수의 호스트가 네트워크에 접근하려는 상황
    - 이 경우 충돌 발생
- 충돌 검출(collision detection)
    - 충돌 검출(collision detection) 시 전송이 중단되고, 충돌을 검출한 호스트는 다른 호스트들에게 충돌이 발생했음을 알리고자 잼 신호(jam signal) 발신
    - 임의의 시간 동안 대기 후 전송 재개

## 2.4 스위치

### 스위치(Switch)

- 데이터 링크 계층의 네트워크 장비
- 특정 MAC 주소를 가진 호스트에만 프레임을 전달할 수 있음
- 전이중(full duplex) 모드 통신을 지원
- 포트별로 콜리전 도메인을 나누고, 전이중 모드로 통신하므로 CSMA/CD 프로토콜이 필요하지 않음

### MAC 주소 학습

- 스위치는 특정 포트와 해당 포트에 연결된 호스트의 MAC 주소와의 관계를 기억하여 원하는 호스트에만 프레임을 전달할 수 있음
- 포트와 연결된 호스트의 MAC 주소 연관 관계를 MAC 주소 테이블에 저장
- 기능
    - 플러딩(flooding)
        - 아직 수신지 호스트의 MAC 주소와 연결된 포트를 알지 못할 때, 스위치가 허브처럼 송신지 포트를 제외한 모든 포트로 프레임을 전송하는 것
    - 필터링(filtering)
        - 전달받은 프레임을 어디로 내보내고 어디로 내보내지 않을지 결정하는 것
    - 포워딩(forwarding)
        - 프레임이 전송될 포트에 실제로 프레임을 내보내는 것
    - 에이징(ageing)
        - MAC 주소 테이블에 등록된 특정 포트에서 일정 시간 동안 프레임을 전송받지 못했을 때 해당 항목을 삭제하는 것

### VLAN (Virtual LAN)

- 한 대의 스위치로 가상의 LAN을 만드는 방법
- 호스트의 물리적 위치와 관계없이 논리적인 LAN을 구성할 수 있음